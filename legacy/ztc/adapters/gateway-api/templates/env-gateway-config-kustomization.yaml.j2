{# Source: zerotouch-platform/bootstrap/argocd/overlays/main/dev/gateway-config/kustomization.yaml #}
{# Migration: Converted to Jinja2 template with environment-specific issuer patches #}
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

resources:
- ../../core/gateway/gateway-config

{% if environment in ['dev', 'staging'] %}
patches:
- target:
    kind: Certificate
    name: {{ domain | replace('.', '-') }}-tls-cert
  patch: |-
    - op: replace
      path: /spec/issuerRef/name
      value: letsencrypt-staging
- target:
    kind: Gateway
    name: public-gateway
  patch: |-
    - op: replace
      path: /metadata/annotations/cert-manager.io~1cluster-issuer
      value: letsencrypt-staging
{% endif %}
